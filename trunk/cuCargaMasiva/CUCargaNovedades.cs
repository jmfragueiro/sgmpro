///////////////////////////////////////////////////////////
//  CUGestionar.cs
//  Clase de control para el caso de uso de gestion efectiva
//  de una cuenta morosa.
//  Generated by Fito
//  Created on:      08-abr-2009 11:32:54
//  Original author: Fito
///////////////////////////////////////////////////////////
using System;
using System.Windows.Forms;
using scioBaseLibrary.excepciones;
using scioBaseLibrary.interfases;
using scioToolLibrary;

namespace cuCargaMasiva {
    public class CUCargaNovedades : IControladorCasoUso {
        private string _titulo, _novedad;
        /// <summary>
        /// Implementación de la propiedad de la interfaz.
        /// </summary>
        public object Padre { get; set; }

        #region Implementation of IControladorCasoUso
        /// <summary>
        /// Implementación del método de la interfaz.
        /// </summary>
        /// <param name="padre">
        /// En éste caso el objeto padre del caso de uso es un Form.
        /// </param>       
        /// <param name="valor">
        /// Aqui se espera que venga: [0](string)=el nombre del caso de uso
        /// [1]El tipo de novedades a cargar.
        /// </param>
        public bool iniciar(object padre, params object[] valor) {
            try {
                // Crea el panel para asignar el objeto a trabajar
                Padre = padre;

                // Acepta los parametros pasados como argumento
                aceptarParametros(valor);

                // Abre la ventana para las tareas de edición, etc.
                (new WinNovedades(_novedad) {
                    StartPosition = FormStartPosition.CenterScreen,
                    Text = string.Format("{0} - {1}", Mensaje.TextoMensaje("TITULO-SHOW"), _titulo),
                    Icon = Properties.Resources.masiva
                }).ShowDialog();

                return true;
            } catch (Exception e) {
                throw new AppErrorException("UCCALLER-NOINIT", e.ToString());
            }
        }

        /// <summary>
        /// Implementación del método de la interfaz.
        /// </summary>
        public void aceptarParametros(params object[] parametros) {
            _novedad = (parametros.Length > 1) ? parametros[1].ToString() : "SALDOS";
            _titulo = "Carga de Novedades de Saldos";

            if (_novedad.Equals("CUENTAS"))
                _titulo = "Carga de Nuevas Asignaciones";
            else if (_novedad.Equals("PAGOS"))
                _titulo = "Carga de Novedades de Pagos";
            else if (_novedad.Equals("DESASIGNAR"))
                _titulo = "Carga de Novedades de Desasignacion";
            else if (_novedad.Equals("LEGALES"))
                _titulo = "Carga de Novedades de Gestiones Legales";
            else if (_novedad.Equals("PROMOCIONES"))
                _titulo = "Carga de Novedades de Promociones"; 
        }
        #endregion
    }
}