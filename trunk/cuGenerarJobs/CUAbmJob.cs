///////////////////////////////////////////////////////////
//  CUGenerarJobs.cs
//  Clase de implementación de CUGenerarJobs.
//  Generated by Fito
//  Created on:      08-abr-2009 11:32:54
//  Original author: Fer
///////////////////////////////////////////////////////////
using System.Drawing;
using cuGenerarJobs.Properties;
using scioBaseLibrary.excepciones;
using scioControlLibrary;
using scioToolLibrary;
using sgmpro.dominio.scheduler;

namespace cuGenerarJobs {
    /// <summary>
    ///   Caso de Uso que configura y genera jobs.
    /// </summary>
    public class CUAbmJob : CUAbmGenerico<Job> {
        #region IControladorEditable Members
        /// <summary>
        ///   Implementación del método de la interfaz.
        /// </summary>
        public override PanelABMV<Job> crearPanelEdicion() {
            return new PanelAbmvJob(this);
        }

        /// <summary>
        ///   Implementación del método de la interfaz.
        /// </summary>
        public override Icon getIcono() {
            return Resources.clockplay;
        }

        /// <summary>
        ///   Implementación del método de la interfaz.
        /// </summary>
        public override void verify(params object[] parametros) {
            if (string.IsNullOrEmpty(ObjetoEnEdicion.Nombre))
                throw new DataErrorException("CAMPO-NOK", Mensaje.TextoValidacion("JOB-NOMBRE"));

            if (string.IsNullOrEmpty(ObjetoEnEdicion.Descripcion))
                throw new DataErrorException("CAMPO-NOK", Mensaje.TextoValidacion("JOB-DESC"));

            if (!Validador.ValidarDiasCrontab(ObjetoEnEdicion.Crontab))
                throw new DataErrorException("CAMPO-NOK", Mensaje.TextoValidacion("JOB-CRONTAB"));
        }
        #endregion
    }
}