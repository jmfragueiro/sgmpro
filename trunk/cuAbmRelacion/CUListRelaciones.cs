///////////////////////////////////////////////////////////
//  CUListRelaciones.cs
//  Clase de implementación de CUListRelaciones.
//  Generated by Fito
//  Created on:      08-abr-2009 11:32:54
//  Original author: Fito
///////////////////////////////////////////////////////////
using scioBaseLibrary;
using scioControlLibrary;
using scioControlLibrary.enums;
using scioPersistentLibrary.criterios;
using scioPersistentLibrary.interfases;
using scioPersistentLibrary.orden;
using scioToolLibrary.enums;
using sgmpro.dominio.configuracion;

namespace cuAbmRelacion {
    /// <summary>
    /// Esta clase hereda de CUListGenerico y se encarga de 
    /// gestionar un PanelListABMV para la entidad Relacion.
    /// </summary>
    public class CUListRelaciones : CUListGenerico<Relacion> {
        /// <summary>
        /// Constructor de la clase que inicializa elementos internos.
        /// </summary>
        public CUListRelaciones() {
            ControlEditable = new CUAbmRelacion();
            Ordenamiento.Add(Orden.Asc("Tipo"));
        }

        #region IControladorListable Members
        /// <summary>
        /// Implementación del método de la interfaz. Aqui se verifica 
        /// y solo se permite editar la Relación si es la Persona actual
        /// es Origen de la misma.
        /// </summary>
        public override void listEdit(params object[] parametros) {
            if (!(_panelListado.getObjetoActual()).Destino.Equals(ObjetoMaster)) {
                ControlEditable.edit(parametros);
                ControlEditable.iniciar(
                    Padre,
                    new object[] {EModoVentana.EDIT, _panelListado.getObjetoActual()});
            } else
                Sistema.Controlador
                    .mostrar("DATA-EDITORIGEN", ENivelMensaje.ERROR, ObjetoMaster.ToString(), true);
        }

        /// <summary>
        /// Implementación del método de la interfaz.
        /// </summary>
        public override ICriterioConsulta getFiltroMaster() {
            return Criterios.Or(
                Criterios.Igual("Origen", ObjetoMaster),
                Criterios.Igual("Destino", ObjetoMaster));
        }
        #endregion
    }
}